sudo: true
language: haskell

git:
  depth: 5

cabal: "2.4"

before_cache:
  - cabal v2-clean
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/build-reports.log
  # remove files that are regenerated by 'cabal update'
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/00-index.*
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/*.json
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/01-index.cache
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/01-index.tar
  - rm -fv $HOME/.cabal/packages/hackage.haskell.org/01-index.tar.idx

cache:
  directories:
  - "$HOME/.cabal/store"
  

matrix:
  include:
  - ghc: 8.6.4
  - ghc: "8.4.4"
  - ghc: "8.2.2"
  - ghc: "8.0.2"  

install:
  - cabal --version
  - ghc --version
  - travis_retry cabal v2-update -v

script:
  - cabal v2-build --enable-tests --enable-benchmarks -v
  - cabal v2-test --enable-tests -v
  - cabal v2-bench --enable-benchmarks --enable-optimization=2 -v

